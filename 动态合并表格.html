<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
<title>表格相同内容合并</title> 
</head> 
<body> 
合并前： 
<table  width="400" border="1" id="table1"> 
    <tr> 
        <td>a</td> <td>2</td> <td>2</td> 
        <td>3</td> <td>4</td> <td>5</td> 
    </tr> 
    <tr> 
        <td>a</td> <td>2</td> <td>5</td>
        <td>3</td> <td>4</td> <td>6</td> 
    </tr> 
    <tr> 
        <td>b</td><td>2</td> <td>3</td> 
        <td>3</td><td>4</td> <td>4 </td> 
    </tr> 
    <tr> 
        <td>a</td> <td>3</td> <td>4</td> 
        <td>6</td> <td>7</td> <td>4 </td> 
    </tr> 
    <tr> 
        <td>a</td> <td>3</td> <td>5</td> 
        <td>6</td> <td>7</td> <td>4 </td> 
    </tr> 
    <tr> 
        <td>cc</td> <td>2</td> <td>3</td> 
        <td>4</td> <td>5</td><td>4 </td> 
    </tr> 
    <tr> 
        <td>cc</td> <td>2</td> <td>3</td> 
        <td>5</td> <td>5</td> <td> </td> 
    </tr> 
</table>
</body> 
</html>
<script type="text/javascript">
    (function(ele){
        var tab=document.getElementById(ele);
        var rows=tab.rows;
        var rowlen=rows.length;
        var collen=rows[0].cells.length;
        var rowStart=0;
        for(var i=0;i<rowlen-1;i++){
            for(var j=i+1;j<rowlen;j++){
                if(tab.rows[j].cells[0].innerHTML==tab.rows[i].cells[0].innerHTML){
                    tab.rows[j].removeChild(tab.rows[j].cells[0]);
                    if(j>=rowlen-1){
                        tab.rows[i].cells[0].rowSpan=j-i+1+"";
                    } 
                }else{
                    tab.rows[i].cells[0].rowSpan=j-i+"";
                    i=j-1;
                    break;
                }
            }    
        }
        for(var i=0;i<collen-1;i++){
            for(var j=i+1;j<collen;j++){
                if(tab.rows[0].cells[j].innerHTML==tab.rows[0].cells[i].innerHTML){
                    tab.rows[0].removeChild(tab.rows[0].cells[j]);
                    if(j>=collen-1){
                        tab.rows[0].cells[i].colSpan=j-i+1+"";
                    } 
                }else{
                    tab.rows[0].cells[i].colSpan=j-i+"";
                    i=j-1;
                    break;
                }
            }    
        }
    })('table1')
</script>  